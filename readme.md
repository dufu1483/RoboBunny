# 🐰 彈力兔 RoboBunny 專案指南

這是一個互動式的網頁遊戲專案，旨在透過圖形化程式積木 (Block-based coding) 來控制兔子收集草莓。專案結合了遊戲引擎、地圖編輯器與積木編輯器。

## 📁 檔案結構與架構
本專案採用原生的 HTML/CSS/JavaScript 開發，不需要建置工具 (Build tools)，直接在瀏覽器開啟 `index.html` 即可執行。

```text
rabbit/
├── index.html        # 應用程式入口與主要 UI 結構
├── styles.css        # 所有樣式定義 (包含 RWD 響應式設計)
├── app.js            # 應用程式核心，負責整合各模組
├── game-engine.js    # 遊戲核心邏輯 (狀態、移動、規則)
├── map-designer.js   # 地圖設計器模組 (繪製、存檔)
└── block-editor.js   # 積木編輯器模組 (拖拉介面、程式碼生成)
```

## 🧩 核心模組介紹

### 1. 應用程式核心 (`app.js`)
這是整個程式的入口點。
-   **職責**: 初始化其他模組 (`MapDesigner`, `GameEngine`, `BlockEditor`)。
-   **功能**:
    -   處理標籤頁 (Tab) 切換 (地圖設計 vs 開始遊戲)。
    -   管理地圖選擇器的連動 (當儲存新地圖時更新下拉選單)。
    -   首次啟動時生成「範例地圖」。

### 2. 遊戲引擎 (`game-engine.js`)
負責遊戲的邏輯運算與狀態管理。
-   **職責**: 執行使用者編寫的程式，控制兔子移動。
-   **關鍵類別**: `GameEngine`
-   **核心功能**:
    -   `executeProgram(program)`: 執行積木指令序列。
    -   `moveBunny(x, y)`: 處理移動、邊界檢查、吃草莓與撞石頭邏輯。
    -   `turn(direction)`: 處理轉向。
    -   **計步器**: 追蹤移動次數 (忽略轉向)。

### 3. 地圖設計器 (`map-designer.js`)
讓使用者自定義關卡的工具。
-   **職責**: 提供格狀畫布，讓使用者繪製地圖元素。
-   **功能**:
    -   **智慧切換 (Smart Cycle)**: 點擊格子可在 空地 -> 草莓(1-3) -> 石頭 -> 空地 之間循環。
    -   **工具列**: 以及傳統的指定工具 (草莓、石頭、兔子起點)。
    -   **存檔管理**: 使用 `localStorage` 本地儲存地圖資料 (JSON 格式)。
    -   **參數設定**: 可設定每張地圖的「積木數量限制」。

### 4. 積木編輯器 (`block-editor.js`)
圖形化的程式撰寫介面。
-   **職責**: 處理積木的拖放 (Drag & Drop)、參數設定與程式碼生成。
-   **UI 元件**:
    -   **工具箱 (Palette)**: 提供 `F_Jump`, `Turn`, `Repeat` 等積木。
    -   **程式區 (Canvas)**: 組裝積木的地方，支援巢狀迴圈 (Nested Loops)。
-   **特色**:
    -   `Repeat` 積木支援自定義次數 (Input 輸入框)。
    -   防止在輸入參數時誤觸發拖曳。
    -   即時顯示積木使用量統計。

## 🎨 設計與樣式 (`styles.css`)
-   **視覺風格**: 採用深色模式 (Dark Mode)，搭配霓虹光暈 (Glow effects) 的現代科技感。
-   **響應式設計 (RWD)**:
    -   **遊戲區**: 在寬度 < 1300px 時自動切換為垂直排列。
    -   **地圖設計區**: 在寬度 < 1000px 時切換為垂直排列。
-   **動畫**: 使用 CSS Transitions 實現平滑的兔子跳躍與轉向動畫。

## 🚀 專案特色功能
1.  **所見即所得的地圖設計**: 設計完直接切換分頁即可遊玩。
2.  **邏輯訓練**: 包含迴圈 (`Repeat`) 與基本循序邏輯。
3.  **防呆機制**: 邊界檢查、石頭障礙扣分機制。
4.  **本地持久化**: 即使關閉瀏覽器，自製的地圖也不會消失。

---
*這份文件由 Antigravity 協助生成。*
